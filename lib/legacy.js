"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var s=e(require("jszip")),t=e(require("file-saver")),o=e(require("lodash.map")),r=e(require("lodash.escape"));const n=e=>{if("number"!=typeof e)return"";const s=Math.floor(e/26),t=String.fromCharCode(97+e%26).toUpperCase();return 0===s?t:n(s-1)+t};var a=(e,s)=>`${n(e)}${s}`,l=(e,s,t)=>isNaN(e)?((e,s,t)=>`<c r="${a(e,t)}" t="inlineStr"><is><t>${r(s)}</t></is></c>`)(s,e,t):((e,s,t)=>`<c r="${a(e,t)}"><v>${s}</v></c>`)(s,e,t),m=e=>o(e,(e,s)=>((e,s)=>{const t=s+1,r=o(e,(e,s)=>l(e,s,t)).join("");return`<row r="${t}">${r}</row>`})(e,s)).join(""),i='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mx="http://schemas.microsoft.com/office/mac/excel/2008/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mv="urn:schemas-microsoft-com:mac:vml" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:xm="http://schemas.microsoft.com/office/excel/2006/main"><workbookPr/><sheets>{placeholder}</sheets><definedNames/><calcPr/></workbook>',c='<?xml version="1.0" ?>\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n{placeholder}\n</Relationships>',p='<?xml version="1.0" ?>\n<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\n<Default ContentType="application/xml" Extension="xml"/>\n<Default ContentType="application/vnd.openxmlformats-package.relationships+xml" Extension="rels"/>\n{placeholder}\n<Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" PartName="/xl/workbook.xml"/>\n</Types>',h='<?xml version="1.0" ?>\n<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mv="urn:schemas-microsoft-com:mac:vml" xmlns:mx="http://schemas.microsoft.com/office/mac/excel/2008/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:xm="http://schemas.microsoft.com/office/excel/2006/main"><sheetData>{placeholder}</sheetData></worksheet>';const f=e=>{const s=m(e);return h.replace("{placeholder}",s)};exports.generateXMLWorksheet=f,exports.xljsxLite=function(e){if(!(e=>{let s=!0;if(!e.filename)return console.error("xljsx-lite config missing property filename"),!1;if("string"!=typeof e.filename&&(console.error("xljsx-lite filename can only be of type string"),s=!1),!e.sheets)return console.error("xljsx-lite config missing property sheets"),!1;0===e.sheets.length&&(console.error("xljsx-lite sheet data is not of type array"),s=!1);for(let t=0;t<e.sheets.length;t+=1)e.sheets[t].filename&&"string"!=typeof e.sheets[t].filename&&(console.error("xljsx-lite sheetName can only be of type string"),s=!1),Array.isArray(e.sheets[t].data)?e.sheets[t].data.every(e=>Array.isArray(e))||(console.error("xljsx-lite sheet data childs is not of type array"),s=!1):(console.error("xljsx-lite sheet data is not of type array"),s=!1);return s})(e))throw new Error("Validation failed.");return(e=>{const t=new s;let o="",r="",n="";for(let s=0;s<e.sheets.length;s+=1){const a=s+1;t.file(`xl/worksheets/sheet${a}.xml`,f(e.sheets[s].data)),o+=`<Override ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" PartName="/xl/worksheets/sheet${a}.xml"/>`,r+=`<sheet name="${e.sheets[s].sheetName||`Sheet${a}`}" sheetId="${a}" r:id="rId${a}"/>`,n+=`<Relationship Id="rId${a}" Target="worksheets/sheet${a}.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"/>`}return t.file("xl/workbook.xml",i.replace("{placeholder}",r)),t.file("xl/_rels/workbook.xml.rels",c.replace("{placeholder}",n)),t.file("[Content_Types].xml",p.replace("{placeholder}",o)),t.file("_rels/.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>'),t})(e).generateAsync({type:s.support.blob?"blob":"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}).then(s=>{t.saveAs(s,`${e.filename}.xlsx`)})};
